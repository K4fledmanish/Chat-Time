{"version":3,"sources":["../../../src/commands/apply/configureAndroidProjectAsync.ts"],"names":["configureAndroidProjectAsync","projectRoot","platforms","packageName","expoUsername","process","env","EAS_BUILD_USERNAME","UserManager","getCurrentUsernameAsync","exp","config","skipSDKVersionRequirement","isModdedConfig","package","log","isDebug","debug","mods","rest","info","JSON","stringify"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAEe,eAAeA,4BAAf,CAA4C;AACzDC,EAAAA,WADyD;AAEzDC,EAAAA;AAFyD,CAA5C,EAMZ;AACD;AACA,QAAMC,WAAW,GAAG,MAAM,+CAAsBF,WAAtB,CAA1B;AACA,QAAMG,YAAY,GAChBC,OAAO,CAACC,GAAR,CAAYC,kBAAZ,KAAmC,MAAMC,mBAAYC,uBAAZ,EAAzC,CADF;AAGA,MAAI;AAAEC,IAAAA,GAAG,EAAEC;AAAP,MAAkB,yBAAUV,WAAV,EAAuB;AAC3CW,IAAAA,yBAAyB,EAAE,IADgB;AAE3CC,IAAAA,cAAc,EAAE;AAF2B,GAAvB,CAAtB,CANC,CAWD;;AACAF,EAAAA,MAAM,GAAG,6CAAuBA,MAAvB,EAA+B;AACtCG,IAAAA,OAAO,EAAEX,WAD6B;AAEtCC,IAAAA;AAFsC,GAA/B,CAAT,CAZC,CAiBD;;AACAO,EAAAA,MAAM,GAAG,MAAM,uCAAiBA,MAAjB,EAAyB;AAAEV,IAAAA,WAAF;AAAeC,IAAAA;AAAf,GAAzB,CAAf;;AAEA,MAAIa,eAAIC,OAAR,EAAiB;AACfD,mBAAIE,KAAJ;;AACAF,mBAAIE,KAAJ,CAAU,2BAAV,EAFe,CAGf;;;AACA,UAAM;AAAEC,MAAAA,IAAF;AAAQ,SAAGC;AAAX,QAAoBR,MAA1B;;AACAI,mBAAIK,IAAJ,CAASC,IAAI,CAACC,SAAL,CAAeH,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAAT;;AACAJ,mBAAIK,IAAJ,CAASF,IAAT;;AACAH,mBAAIE,KAAJ;AACD;AACF","sourcesContent":["import { getConfig } from '@expo/config';\nimport { compileModsAsync, ModPlatform, withExpoAndroidPlugins } from '@expo/config-plugins';\nimport { UserManager } from '@expo/xdl';\n\nimport log from '../../log';\nimport { getOrPromptForPackage } from '../eject/ConfigValidation';\n\nexport default async function configureAndroidProjectAsync({\n  projectRoot,\n  platforms,\n}: {\n  projectRoot: string;\n  platforms: ModPlatform[];\n}) {\n  // Check package before reading the config because it may mutate the config if the user is prompted to define it.\n  const packageName = await getOrPromptForPackage(projectRoot);\n  const expoUsername =\n    process.env.EAS_BUILD_USERNAME || (await UserManager.getCurrentUsernameAsync());\n\n  let { exp: config } = getConfig(projectRoot, {\n    skipSDKVersionRequirement: true,\n    isModdedConfig: true,\n  });\n\n  // Add all built-in plugins\n  config = withExpoAndroidPlugins(config, {\n    package: packageName,\n    expoUsername,\n  });\n\n  // compile all plugins and mods\n  config = await compileModsAsync(config, { projectRoot, platforms });\n\n  if (log.isDebug) {\n    log.debug();\n    log.debug('Evaluated Android config:');\n    // @ts-ignore: mods not on config type\n    const { mods, ...rest } = config;\n    log.info(JSON.stringify(rest, null, 2));\n    log.info(mods);\n    log.debug();\n  }\n}\n"],"file":"configureAndroidProjectAsync.js"}